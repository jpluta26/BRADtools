
# derive the standard error of an estimated coefficient, 
# given the estimate and the confidence interval
# assumes data comes from a logistic regression
getSEfromCI <- function(OR, ci.lo, ci.hi)
#  input: OR, the odds ratio estimated by logistic regression
#   ci.lo: the low end of the OR
#   ci.hi: the high end of the OR
#  output: se, the standard error of the coefficient
#   this is the standard error of the original estimated coefficient,
#   eg logOR
{

  # CI in logistic regression is asymmetrical
  # take the average for most stable estimate
  se.1 <- abs( (log(ci.lo) - log(OR)) / 1.96 )
  se.2 <- abs( (log(ci.hi) - log(OR)) / 1.96 )
  se <- mean(se.1, se.2)
  
  return(se)
}
